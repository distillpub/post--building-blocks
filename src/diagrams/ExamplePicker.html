<:Window bind:innerWidth="winWidth" bind:scrollY='scrollY'/>

<div ref:picker id="example-picker" class="{{div_class}}" style="--left: {{left}}px;">
  
  <img src="examples/input_images/{{example}}.png" alt="{{example}}" class="selected" />

  {{#each examples as ex}}
    {{#if ex !== example}}
      <img src="examples/input_images/{{ex}}.png" alt="{{ex}}" on:click="set({example: ex})" />
    {{/if}}
  {{/each}}
</div>

<style>
  #example-picker {
    overflow: hidden;
    transition-duration: .5s;
    transition-timing-function: ease-in-out;
  }

  #example-picker img {
    width: 44px;
    cursor: pointer;
    opacity: 0.4;
    border: 3px solid #fff;
    border-radius: var(--border-radius);
  }

  #example-picker img.selected {
    opacity: 1;
    border-color: #ff6600;
  }

  #example-picker img:hover { 
    opacity: 1;
    border-color: #3497FF;
  }

  .one {
    position: absolute;
    top: 25px;
    height: 525px;
    width: 50px;
    margin-left: -90px;
    transition-property: width, height;
  }

  .two {
    position: fixed;
    top: 20px;
    left: calc(var(--left) - 90px);
    height: 50px;
    width: 50px;
    transition-property: width, height, left;
  }

  .three {
    position: fixed;
    top: 20px;
    left: 20px;
    height: 50px;
    width: 50px;
    opacity: 0.5;
    transition-property: width, height, left;
  }

  .two:hover, .three:hover {
    opacity: 1;
    height: 525px;
  }
</style>

<script>
  const examples = require('../../static/examples').examples;

  export default {
    data() {
      return {examples};
    },

    oncreate() {
      this.set({left: this.refs.picker.parentNode.getBoundingClientRect().left});
    },

    computed: {
      left (winWidth) {
        const picker = document.querySelector('#example-picker');
        return picker && picker.parentNode.getBoundingClientRect().left;
      },

      div_class (scrollY) {
        const img = document.querySelector('#SemanticDict .input_image');
        if (!img) return 'one';

        const bb = img.getBoundingClientRect();
        return bb.top <= -bb.height ? 'three' :
          bb.top <= 20 ? 'two' : 'one';
      }
    }
  }
</script>